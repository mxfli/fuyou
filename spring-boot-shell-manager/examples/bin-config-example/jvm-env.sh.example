#!/bin/bash
#
# JVM 可调参数配置文件示例
# 复制此文件为 jvm-env.sh 并根据需要修改参数
#

# ============================================================================
# 内存配置
# ============================================================================
# 初始堆内存大小
JVM_XMS="2g"

# 最大堆内存大小
JVM_XMX="4g"

# Metaspace 初始大小（JDK 8+）
JVM_METASPACE_SIZE="128m"

# Metaspace 最大大小（JDK 8+）
JVM_MAX_METASPACE_SIZE="512m"

# PermGen 初始大小（仅 JDK 8）
JVM_PERM_SIZE="256m"

# PermGen 最大大小（仅 JDK 8）
JVM_MAX_PERM_SIZE="512m"

# 线程栈大小（可选，留空使用JVM默认值）
JVM_THREAD_STACK_SIZE=""

# ============================================================================
# GC 配置
# ============================================================================
# G1GC 最大暂停时间（毫秒）
JVM_MAX_GC_PAUSE_MS="200"

# G1GC 启动并发GC的堆占用阈值（百分比）
JVM_IHOP="45"

# GC 日志文件大小
JVM_GC_LOG_FILESIZE="20M"

# GC 日志文件数量
JVM_GC_LOG_FILECOUNT="5"

# ============================================================================
# 故障诊断配置
# ============================================================================
# 堆转储文件路径（发生OOM时）
JVM_HEAP_DUMP_PATH="${LOG_DIR}/heapdump.hprof"

# JVM 错误日志文件路径
JVM_ERROR_FILE="${LOG_DIR}/hs_err_pid%p.log"

# ============================================================================
# 应用配置
# ============================================================================
# 应用主类（重要：根据实际应用修改）
# 常见选项：
# - org.springframework.boot.loader.JarLauncher  (Spring Boot Fat JAR)
# - org.springframework.boot.loader.WarLauncher  (Spring Boot WAR)
# - com.example.Application                       (自定义主类)
MAIN_CLASS="org.springframework.boot.loader.JarLauncher"

# ============================================================================
# 额外 JVM 参数
# ============================================================================
# 自定义 JVM 参数（会追加到默认参数后面）
EXTRA_JAVA_OPTS="-Djava.awt.headless=true -Dfile.encoding=UTF-8"

# ============================================================================
# 示例配置说明
# ============================================================================
# 1. 如果您的应用是通过 maven jar:jar 打包的，通常需要指定具体的主类
# 2. 如果您的应用是 Spring Boot Fat JAR，使用 JarLauncher
# 3. 内存配置应根据实际应用需求和服务器资源调整
# 4. GC 参数适用于大多数应用，特殊需求可以调整